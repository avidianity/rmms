(this.webpackJsonpfrontend=this.webpackJsonpfrontend||[]).push([[18],{137:function(e,a,s){e.exports={card:"auth_card__2Fqm8",icon:"auth_icon__1YXzV"}},267:function(e,a,s){"use strict";s.r(a);var t=s(2),r=s.n(t),c=s(6),n=s(7),i=s(1),d=s(88),o=s(4),l=s(13),u=s(137),b=s.n(u),m=s(240),j=s(249),p=s(3),f=s.n(p),h=s(16),O=s.n(h),x=s(14),g=s(11),v=s.p+"static/media/center.aad078aa.jpg",N=s(21),k=s.n(N),w=s(0);a.default=function(e){var a=Object(i.useState)(!1),s=Object(n.a)(a,2),t=s[0],u=s[1],p=Object(i.useState)(0),h=Object(n.a)(p,2),N=h[0],y=h[1],S=Object(i.useState)(x.a.get("background-color")||"dark"),A=Object(n.a)(S,2),D=A[0],_=A[1],q=Object(d.b)({resolver:Object(m.yupResolver)(j.a().shape({email:j.b().required("Email Address is required.").email(),password:j.b().required("Password is required.")}))}),R=q.register,E=q.handleSubmit,H=q.errors,J=Object(o.f)(),M=function(){var e=Object(c.a)(r.a.mark((function e(a){var s,t,c,n,i,d;return r.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(u(!0),!(s=x.a.get("auth-expires"))){e.next=9;break}if(t=k()(s),!k()(new Date).isAfter(t)){e.next=8;break}x.a.remove("auth-expires"),e.next=9;break;case 8:return e.abrupt("return",O.a.info("Authentication temporarily disabled. Please try again after a few minutes."));case 9:return e.prev=9,e.next=12,f.a.post("/auth/login",a);case 12:c=e.sent,n=c.data,i=n.user,d=n.token,x.a.set("user",i),x.a.set("token",d),O.a.success("Welcome back, ".concat(i.name,"!")),J.push(l.a.DASHBOARD),e.next=27;break;case 22:e.prev=22,e.t0=e.catch(9),y(N+1),(N>=3||N+1>=3)&&(x.a.set("auth-expires",k()(new Date).add(2,"minutes").toJSON()),setTimeout((function(){return x.a.remove("auth-expires")}),12e4)),Object(g.b)(e.t0);case 27:return e.prev=27,u(!1),e.finish(27);case 30:case"end":return e.stop()}}),e,null,[[9,22,27,30]])})));return function(a){return e.apply(this,arguments)}}();return Object(i.useEffect)((function(){var e=x.a.listen("background-color",(function(e){return _(e)}));return function(){x.a.unlisten("background-color",e)}}),[]),x.a.has("user")?(J.push(l.a.DASHBOARD),null):Object(w.jsx)("div",{className:"d-flex h-100vh align-items-center justify-content-center wrapper","data-mode":D,style:{backgroundImage:"url(".concat(v,")"),backgroundSize:"cover",backgroundRepeat:"no-repeat"},children:Object(w.jsxs)("div",{className:"card ".concat(b.a.card),children:[Object(w.jsxs)("div",{className:"card-header text-center",children:[Object(w.jsx)("img",{src:"/assets/img/manifest-icon-512.png",alt:"",className:"rounded-circle shadow border ".concat(b.a.icon," my-2")}),Object(w.jsx)("h4",{className:"card-title mt-1",children:"Records Monitoring and Management System"}),Object(w.jsx)("h5",{className:"card-title",children:"MCHG"})]}),Object(w.jsx)("form",{onSubmit:E(M),children:Object(w.jsxs)("div",{className:"card-body",children:[Object(w.jsxs)("div",{className:"form-group bmd-form-group",children:[Object(w.jsx)("label",{className:"bmd-label-floating",children:"Email Address"}),Object(w.jsx)("input",{ref:R,type:"email",name:"email",id:"email",className:"form-control ".concat(Object(g.d)(H.email,"is-invalid")),disabled:t}),H.email?Object(w.jsx)("div",{className:"invalid-feedback",children:H.email.message}):null]}),Object(w.jsxs)("div",{className:"form-group bmd-form-group",children:[Object(w.jsx)("label",{className:"bmd-label-floating",children:"Password"}),Object(w.jsx)("input",{ref:R,type:"password",name:"password",id:"password",className:"form-control ".concat(Object(g.d)(H.password,"is-invalid")),disabled:t}),H.password?Object(w.jsx)("div",{className:"invalid-feedback",children:H.password.message}):null]}),Object(w.jsx)("div",{className:"form-group ",children:Object(w.jsx)("button",{type:"submit",className:"btn btn-success btn-sm w-100",disabled:t,children:t?Object(w.jsx)("i",{className:"material-icons spin",children:"refresh"}):"Login"})}),Object(w.jsx)("div",{className:"d-flex"})]})})]})})}}}]);
//# sourceMappingURL=18.f48e798a.chunk.js.map